# Используем базовый образ Node.js
FROM node:22-alpine

# Устанавливаем рабочую директорию
WORKDIR /app

# --- ЭТОТ БЛОК БОЛЬШЕ НЕ НУЖЕН ДЛЯ NPM ---
# RUN corepack enable

# Копируем только файлы зависимостей для кэширования этого слоя
COPY package.json package-lock.json ./

# Устанавливаем зависимости
RUN npm install

# Копируем остальной код проекта.
# Этот шаг нужен для сборки "полного" образа, хотя при запуске мы будем использовать volume.
COPY . .

# Nuxt 3 по умолчанию запускает dev server на порту 3000
EXPOSE 3000

# Команда для запуска сервера разработки
CMD ["npm", "run", "dev"]
